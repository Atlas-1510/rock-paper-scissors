<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rock Paper Scissors</title>
</head>

<body>
    <script>
        let choices = ["rock", "paper", "scissors"];
        let drawCount = 0;
        // Game activation
        game();

        // Game function, plays five rounds and determines overall winner
        function game() {
            let winCounter = 0;
            let maxGames = 5;
            let i;
            for (i = 0; i < maxGames; i++) {
                let game = RockPaperScissors();
                if (game) {
                    winCounter += 1;
                }
                console.log(`The score is Player: ${winCounter} and Computer: ${i + 1 - winCounter}.
                There have been ${drawCount} draws so far. It is currently round ${i + 1}`)
            }
            if (winCounter > (maxGames / 2)) {
                console.log(`You won the game! Final score was Player: ${winCounter} 
                and Computer: ${i + 1 - winCounter}`);
            } else {
                console.log(`You lost the game! Final score was Player: ${winCounter} 
                and Computer: ${i + 1 - winCounter}`);
            }
        }

        // Gets computer choice for each round
        function computerPlay() {
            let randomNumber = Math.floor(Math.random() * 3);
            let computerChoice = choices[randomNumber];
            return computerChoice;
        }

        // Gets player choice for each round
        function getPlayerSelection() {
            let playerSelection = prompt("Please choose 'rock', 'paper', or 'scissors': ")
            playerSelection = playerSelection.toLowerCase();
            if (choices.includes(playerSelection)) {
                return playerSelection;
            } else {
                getPlayerSelection();
            }
        }

        // Determines winner of each round. Return true if player won, returns false if computer won.
        // If draw, repeats round until winner determined.
        function RockPaperScissors(playerSelection, computerSelection) {
            if (playerSelection == "rock" && computerSelection == "scissors") {
                console.log(`You win! ${playerSelection} beats ${computerSelection}`);
                return true;
            } else if (playerSelection == "rock" && computerSelection == "paper") {
                console.log(`You lose! ${playerSelection} loses to ${computerSelection}`);
                return false;
            } else if (playerSelection == "paper" && computerSelection == "rock") {
                console.log(`You win! ${playerSelection} beats ${computerSelection}`);
                return true;
            } else if (playerSelection == "paper" && computerSelection == "scissors") {
                console.log(`You lose! ${playerSelection} loses to ${computerSelection}`);
                return false;
            } else if (playerSelection == "scissors" && computerSelection == "paper") {
                console.log(`You win! ${playerSelection} beats ${computerSelection}`);
                return true;
            } else if (playerSelection == "scissors" && computerSelection == "rock") {
                console.log(`You lose! ${playerSelection} loses to ${computerSelection}`);
                return false;
            } else if (playerSelection == computerSelection) {
                console.log("Draw! Repeat the round.");
                drawCount += 1;
                // If draw, get new player selection and computer selection, and repeat
                let newPlayerSelection = getPlayerSelection();
                let newComputerSelection = computerPlay();
                return RockPaperScissors(newPlayerSelection, newComputerSelection);
            }
        }
    </script>
</body>

</html>